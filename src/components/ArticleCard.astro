---
import { formatRelativeDate, truncate } from '../lib/utils';

interface Props {
  id: string;
  title: string;
  link: string;
  pubDate: Date;
  summary?: string;
  feedTitle: string;
  category: string;
  categorySlug: string;
}

const { title, link, pubDate, summary, feedTitle, category, categorySlug } = Astro.props;

const searchableText = [title, feedTitle, category, summary].filter(Boolean).join(' ');
const relativeDate = formatRelativeDate(pubDate);
const trimmedSummary = summary ? truncate(summary, 160) : '';
---

<article class="article-card" data-searchable={searchableText}>
  <h3 class="article-title">
    <a href={link} target="_blank" rel="noopener noreferrer">{title}</a>
  </h3>
  <div class="article-meta">
    <span>{feedTitle}</span>
    <span class="separator">&middot;</span>
    <time datetime={pubDate.toISOString()}>{relativeDate}</time>
    <span class="separator">&middot;</span>
    <a href={`/category/${categorySlug}`} class="category-tag">{category}</a>
  </div>
  {trimmedSummary && <p class="article-summary">{trimmedSummary}</p>}
</article>
